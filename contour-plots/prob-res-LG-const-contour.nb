(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     64582,       1552]
NotebookOptionsPosition[     60439,       1476]
NotebookOutlinePosition[     60861,       1492]
CellTagsIndexPosition[     60818,       1489]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Probability of resistance for the LG model with constant rates\
\>", "Section",
 CellChangeTimes->{{3.7595107209140425`*^9, 3.7595107288271356`*^9}, {
  3.7595109104163065`*^9, 3.759510910536234*^9}, {3.7656261303604064`*^9, 
  3.765626132600174*^9}, {3.775313664189444*^9, 3.7753136703643913`*^9}, {
  3.775313826899642*^9, 3.775313827690743*^9}, {3.775319359229665*^9, 
  3.775319359908306*^9}, {3.7754880759352417`*^9, 3.7754880775739717`*^9}, {
  3.7806086401959457`*^9, 3.7806086410109177`*^9}, {3.799207169183833*^9, 
  3.799207169431307*^9}},ExpressionUUID->"fd1fea7a-d639-4048-bb8c-\
6dc468ec4f5d"],

Cell[BoxData[
 RowBox[{"<<", "MaTeX`"}]], "Input",
 CellChangeTimes->{{3.7753219865141973`*^9, 3.775321989297694*^9}, {
  3.775333521665347*^9, 3.775333526703018*^9}, {3.775333763208984*^9, 
  3.775333763550456*^9}, {3.77533406652415*^9, 3.775334084394672*^9}, {
  3.7753399114226913`*^9, 3.775339913107452*^9}, {3.7753416434858217`*^9, 
  3.775341654498824*^9}, {3.775341765737176*^9, 3.775341766687077*^9}, {
  3.775342442724608*^9, 3.7753424434740973`*^9}, {3.7753426347749023`*^9, 
  3.775342639177857*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"eb2c62ab-9bfd-4ed5-91fc-ec0003b94c68"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"loopcount", ">", "1"}], ",", 
    RowBox[{"Clear", "@@", 
     RowBox[{"DeleteCases", "[", 
      RowBox[{
       RowBox[{"Names", "@", "\"\<`*\>\""}], ",", 
       RowBox[{"\"\<loopcount\>\"", "|", "\"\<file\>\""}]}], "]"}]}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Head", "[", "loopcount", "]"}], "\[Equal]", "Symbol"}], ",", " ", 
   RowBox[{
    RowBox[{"loopcount", "=", "1"}], ";"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.774950316124591*^9, 3.774950320323986*^9}, {
   3.774951022775563*^9, 3.7749510343394513`*^9}, {3.774951118434326*^9, 
   3.7749511315068207`*^9}, {3.7749521378049607`*^9, 3.774952139348504*^9}, {
   3.774952414086239*^9, 3.774952417682007*^9}, {3.774954970114418*^9, 
   3.7749549747985163`*^9}, 3.783924558787875*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"d6f25946-1477-4c1d-a92a-05b43dfff318"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"$PreRead", "=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"#", "/.", 
       RowBox[{
        RowBox[{"s_String", "/;", 
         RowBox[{
          RowBox[{"StringMatchQ", "[", 
           RowBox[{"s", ",", "NumberString"}], "]"}], "&&", 
          RowBox[{
           RowBox[{"Precision", "@", 
            RowBox[{"ToExpression", "@", "s"}]}], "\[Equal]", 
           "MachinePrecision"}]}]}], "\[RuleDelayed]", 
        RowBox[{"s", "<>", "\"\<`50.\>\""}]}]}], "&"}], ")"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.777690441002927*^9, 3.777690441004684*^9}, {
   3.7776905427713423`*^9, 3.777690544000081*^9}, {3.7776906816633177`*^9, 
   3.777690706708922*^9}, {3.777691144428637*^9, 3.777691165042678*^9}, {
   3.7776912668081293`*^9, 3.777691268213839*^9}, {3.777691331330385*^9, 
   3.7776913318317623`*^9}, {3.7776914180769367`*^9, 3.777691419066517*^9}, {
   3.779564873748609*^9, 3.779564873874731*^9}, {3.780182939387988*^9, 
   3.780182939636668*^9}, {3.780518801967445*^9, 3.780518803109907*^9}, {
   3.780518864362977*^9, 3.780518864591811*^9}, 3.780519716235561*^9, {
   3.78051977740244*^9, 3.780519799223144*^9}, {3.780519977116438*^9, 
   3.780519977244792*^9}, {3.78052006717003*^9, 3.780520067407349*^9}, 
   3.780520321741105*^9, {3.780522694696422*^9, 3.780522699974989*^9}, {
   3.7805227429951487`*^9, 3.7805227430967703`*^9}, {3.780523148223152*^9, 
   3.7805231748130417`*^9}, {3.780525123615924*^9, 3.7805251238216457`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"8d1b2e6a-2189-4251-93c7-e84b7e76a7bc"],

Cell[CellGroupData[{

Cell["Input", "Subsection",
 CellChangeTimes->{{3.765625136077447*^9, 
  3.765625138435857*^9}},ExpressionUUID->"49094584-d4d6-4967-b208-\
7ac06f3597d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"minp", "=", 
    RowBox[{
     RowBox[{"1.4", " ", 
      SuperscriptBox["10", "3"]}], "+", "1"}]}], ";", 
   RowBox[{"dp", "=", "1"}], ";", 
   RowBox[{"maxp", " ", "=", 
    RowBox[{"1.5", " ", 
     SuperscriptBox["10", "3"]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minT", "=", "35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dT", " ", "=", "1"}], ";", 
   RowBox[{"maxT", "=", "35"}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.7749552615145206`*^9, 3.774955263616213*^9}, {
   3.774955408016028*^9, 3.7749554371429586`*^9}, {3.7749556242798586`*^9, 
   3.7749556255560684`*^9}, {3.7749580322713785`*^9, 3.774958035045656*^9}, {
   3.7749591397889905`*^9, 3.774959157768632*^9}, {3.774959669958374*^9, 
   3.7749596703711205`*^9}, {3.7749600796179967`*^9, 3.77496007998177*^9}, {
   3.7749601275215683`*^9, 3.7749601278053937`*^9}, {3.7749602002800217`*^9, 
   3.774960200403943*^9}, {3.774960234671687*^9, 3.7749602524516077`*^9}, {
   3.7749603326868143`*^9, 3.7749603354673076`*^9}, {3.7749604308048806`*^9, 
   3.7749604313055706`*^9}, {3.774960873188307*^9, 3.7749608834369507`*^9}, {
   3.774962062714572*^9, 3.7749620631156483`*^9}, {3.7749623977516637`*^9, 
   3.7749623983064384`*^9}, {3.774962650250868*^9, 3.774962654206621*^9}, 
   3.7749637766221476`*^9, 3.7749645785536346`*^9, {3.774965179013327*^9, 
   3.77496517920794*^9}, {3.7749655725643463`*^9, 3.774965578603182*^9}, {
   3.774965791522504*^9, 3.774965793528241*^9}, {3.77531461428636*^9, 
   3.775314624316105*^9}, {3.775314759675061*^9, 3.775314762711854*^9}, {
   3.775314895109748*^9, 3.7753149037340727`*^9}, {3.775315522565235*^9, 
   3.775315522944893*^9}, {3.775315762690689*^9, 3.775315766136024*^9}, {
   3.775318497116083*^9, 3.775318505329077*^9}, {3.775318596743271*^9, 
   3.7753186288927307`*^9}, {3.775318683840995*^9, 3.775318684622921*^9}, {
   3.775318865839404*^9, 3.775318866299962*^9}, {3.775319515523368*^9, 
   3.775319556801622*^9}, 3.7753328748453407`*^9, 3.775333111578841*^9, {
   3.775333160572407*^9, 3.77533317722084*^9}, {3.7753337003330584`*^9, 
   3.775333710348958*^9}, 3.7753342213780193`*^9, {3.7753399251381598`*^9, 
   3.775339925771523*^9}, {3.7753415295442123`*^9, 3.775341572229494*^9}, {
   3.77534173735306*^9, 3.775341741830435*^9}, {3.77534177599233*^9, 
   3.775341776350024*^9}, {3.775342195982882*^9, 3.775342206548168*^9}, {
   3.7753423969492693`*^9, 3.775342410042532*^9}, {3.775342563097083*^9, 
   3.775342563398185*^9}, {3.775342648307953*^9, 3.775342657129784*^9}, {
   3.775342894030924*^9, 3.775342909881886*^9}, {3.77534373527984*^9, 
   3.7753437354927807`*^9}, 3.775343913004026*^9, {3.77534406586467*^9, 
   3.7753440723343477`*^9}, {3.775344342521228*^9, 3.775344352158689*^9}, {
   3.7753447003504133`*^9, 3.775344703284121*^9}, {3.775344910749222*^9, 
   3.775344918379025*^9}, {3.775346036482671*^9, 3.775346094433372*^9}, {
   3.7753462939149446`*^9, 3.775346300471566*^9}, {3.775346666317391*^9, 
   3.7753466825729523`*^9}, {3.775346746817254*^9, 3.775346747513089*^9}, {
   3.775347059573093*^9, 3.775347064992567*^9}, {3.775347352981032*^9, 
   3.775347358858128*^9}, {3.775348260522255*^9, 3.775348261388543*^9}, {
   3.775348297210863*^9, 3.7753483080579147`*^9}, {3.775348450952582*^9, 
   3.7753484512459927`*^9}, 3.775349128479939*^9, 3.7753492637078943`*^9, {
   3.775392746632444*^9, 3.775392830378993*^9}, {3.7753931712869062`*^9, 
   3.77539317673291*^9}, {3.775393493384907*^9, 3.775393510054451*^9}, {
   3.775394622598257*^9, 3.775394636708425*^9}, {3.77539472610336*^9, 
   3.775394747055287*^9}, {3.775417694404978*^9, 3.7754177080429363`*^9}, {
   3.7754183737794733`*^9, 3.775418374800602*^9}, {3.7754239075604362`*^9, 
   3.7754239079512043`*^9}, {3.775423940231847*^9, 3.775423940319518*^9}, {
   3.775427952827546*^9, 3.7754279602414303`*^9}, {3.775429629441773*^9, 
   3.7754296331031637`*^9}, {3.775472950527598*^9, 3.775472957333251*^9}, {
   3.776735919653926*^9, 3.776735961114427*^9}, {3.7767360647747183`*^9, 
   3.776736084974386*^9}, {3.77673633497886*^9, 3.776736337544585*^9}, 
   3.77682483206343*^9, {3.776827407136743*^9, 3.776827407477457*^9}, {
   3.776828353708767*^9, 3.7768283657382727`*^9}, {3.7768301819879932`*^9, 
   3.776830202250791*^9}, {3.776830473648324*^9, 3.776830474365596*^9}, {
   3.77683322871271*^9, 3.776833229286105*^9}, {3.776833279143918*^9, 
   3.776833292056253*^9}, {3.780522296528975*^9, 3.7805223035038967`*^9}, {
   3.780522398763698*^9, 3.780522411043112*^9}, {3.780522545954403*^9, 
   3.780522551767144*^9}, {3.780523183175056*^9, 3.780523186325274*^9}, 
   3.780523883966873*^9, {3.7805239333269*^9, 3.780523933942523*^9}, {
   3.7805246011886044`*^9, 3.780524645848557*^9}, {3.780524784559219*^9, 
   3.780524784795209*^9}, {3.780609093625375*^9, 3.780609095375132*^9}, {
   3.780609157130351*^9, 3.780609161681013*^9}, {3.783924352083099*^9, 
   3.7839243672588654`*^9}, {3.7839244599208813`*^9, 3.783924463269709*^9}, {
   3.783924660390243*^9, 3.783924661051955*^9}, 3.783924711655649*^9, {
   3.783943864507577*^9, 3.78394386474535*^9}, {3.783943948428598*^9, 
   3.783943951771906*^9}, {3.783944087153977*^9, 3.783944092887285*^9}, {
   3.783996882388068*^9, 3.783996884074341*^9}, {3.783996929523059*^9, 
   3.78399693791541*^9}, {3.783997268483838*^9, 3.783997268937254*^9}, {
   3.7839973943176537`*^9, 3.783997395406081*^9}, {3.783997470258115*^9, 
   3.783997473095435*^9}, {3.783999501446385*^9, 3.783999533340685*^9}, {
   3.784001208524279*^9, 3.784001219729999*^9}, {3.784001927318461*^9, 
   3.784001931972114*^9}, {3.7840021007864847`*^9, 3.784002101373764*^9}, {
   3.784002417725328*^9, 3.784002420506187*^9}, {3.7840024816541357`*^9, 
   3.7840024835723*^9}, {3.784002555049591*^9, 3.784002576142272*^9}, {
   3.7840723124238577`*^9, 3.784072365007059*^9}, {3.784072661783021*^9, 
   3.784072662419335*^9}, {3.7840736677441187`*^9, 3.784073674084783*^9}, {
   3.784073890142385*^9, 3.784073890355536*^9}, {3.784074143662504*^9, 
   3.784074145627811*^9}, {3.784074299979023*^9, 3.784074306898204*^9}, {
   3.784082243176756*^9, 3.7840822445184813`*^9}, {3.784167997413439*^9, 
   3.784168002889998*^9}, {3.7841681005197897`*^9, 3.784168112349195*^9}, {
   3.784168164921826*^9, 3.784168165142815*^9}, 3.793397095893911*^9, {
   3.793397604267915*^9, 3.793397604650786*^9}, {3.793397945055141*^9, 
   3.793397954510741*^9}, {3.793398249840445*^9, 3.793398250202598*^9}, {
   3.7933983109187937`*^9, 3.793398311348678*^9}, {3.793398354752008*^9, 
   3.793398354900483*^9}, {3.793398503699552*^9, 3.793398510098564*^9}, {
   3.793398594928265*^9, 3.793398597365382*^9}, {3.7933986810592127`*^9, 
   3.7933986842159853`*^9}, {3.793398814382944*^9, 3.7933988177321587`*^9}, {
   3.793399168742861*^9, 3.793399175438037*^9}, {3.793399251376795*^9, 
   3.793399270678228*^9}, {3.793399350179638*^9, 3.793399351600588*^9}, {
   3.793399470552741*^9, 3.793399473252396*^9}, {3.793399540001321*^9, 
   3.7933995418148317`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"403b47ee-0141-4f45-8e1d-89022d9e0ff6"],

Cell[CellGroupData[{

Cell["Constant rates", "Subsubsection",
 CellChangeTimes->{{3.7657605471434793`*^9, 
  3.765760549126306*^9}},ExpressionUUID->"86278049-6216-4081-87b2-\
53afb11d8d36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dS", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dA", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dB", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dD", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]S", "=", 
   RowBox[{"1.0", "-", "dS"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]A", "=", 
   RowBox[{"1.1", "-", "dA"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]B", "=", 
   RowBox[{"1.2", "-", "dB"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Rho]D", "=", 
   RowBox[{"1.3", "-", "dD"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]A", "=", 
   RowBox[{"1.0", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "3"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]B", "=", 
   RowBox[{"1.0", " ", 
    SuperscriptBox["10", 
     RowBox[{"-", "4"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n0", "=", 
   SuperscriptBox["10", "3"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kS", "=", 
   RowBox[{"minp", " ", "+", "  ", 
    RowBox[{"dp", "*", 
     RowBox[{"(", 
      RowBox[{"loopcount", "-", "1"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kA", "=", 
   RowBox[{"1.1", " ", 
    SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kB", "=", 
   RowBox[{"1.2", " ", 
    SuperscriptBox["10", "3"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kD", "=", " ", 
   RowBox[{"1.3", " ", 
    SuperscriptBox["10", "3"]}]}], ";", 
  RowBox[{"tmax", " ", "=", " ", "150"}], ";"}]}], "Input",
 CellChangeTimes->{{3.763471929053361*^9, 3.7634719355893097`*^9}, {
   3.763472038172696*^9, 3.7634720410519104`*^9}, 3.765330370569859*^9, {
   3.765422476651327*^9, 3.765422480891567*^9}, {3.765422613552712*^9, 
   3.765422615448271*^9}, {3.765422731932185*^9, 3.765422734355755*^9}, {
   3.765422771400839*^9, 3.765422773764832*^9}, {3.7654236399334927`*^9, 
   3.76542364291441*^9}, {3.765423941164607*^9, 3.765423942769949*^9}, {
   3.770915761122377*^9, 3.7709157684893703`*^9}, {3.775312922917882*^9, 
   3.77531296253714*^9}, {3.7753130387943277`*^9, 3.775313040033601*^9}, {
   3.775314477024118*^9, 3.775314509576486*^9}, {3.77531795227524*^9, 
   3.7753179561921797`*^9}, {3.775318151926893*^9, 3.7753181715030937`*^9}, {
   3.77531831475035*^9, 3.7753183299719887`*^9}, {3.775318575134749*^9, 
   3.775318580667358*^9}, {3.775318872182942*^9, 3.77531888085273*^9}, {
   3.775319568229282*^9, 3.775319578115061*^9}, {3.775333179166223*^9, 
   3.775333179659748*^9}, {3.775333657877696*^9, 3.775333665323999*^9}, {
   3.775333714445634*^9, 3.775333724006344*^9}, {3.77533977765172*^9, 
   3.775339782056067*^9}, {3.7753415564960337`*^9, 3.775341564557337*^9}, {
   3.775343725937934*^9, 3.775343732548546*^9}, {3.775344324064282*^9, 
   3.775344325654739*^9}, {3.775344624365548*^9, 3.775344624490123*^9}, {
   3.7753446865188217`*^9, 3.7753446910365753`*^9}, {3.77534599532267*^9, 
   3.775346021287409*^9}, {3.7753487092498503`*^9, 3.775348729017264*^9}, {
   3.775392846157214*^9, 3.7753928527162447`*^9}, {3.7753932625598497`*^9, 
   3.775393263301448*^9}, {3.775393516409313*^9, 3.775393521238699*^9}, {
   3.775393553448634*^9, 3.775393553534896*^9}, {3.775394626606697*^9, 
   3.775394633843418*^9}, {3.7754176762426767`*^9, 3.775417691675434*^9}, {
   3.775423912025818*^9, 3.775423936199417*^9}, {3.775427941124034*^9, 
   3.775427943784898*^9}, {3.775472886709681*^9, 3.7754728899029818`*^9}, {
   3.776736660862256*^9, 3.776736671530697*^9}, {3.7768274181195507`*^9, 
   3.776827433029736*^9}, {3.776830258470117*^9, 3.7768302719970493`*^9}, {
   3.776833299692128*^9, 3.776833322624886*^9}, {3.7805223590296783`*^9, 
   3.780522374803302*^9}, {3.780523890799645*^9, 3.780523896006023*^9}, {
   3.780524561314196*^9, 3.7805245960672207`*^9}, {3.780525225313415*^9, 
   3.780525238273304*^9}, {3.780525369919343*^9, 3.78052537217341*^9}, {
   3.780525814943521*^9, 3.780525833021227*^9}, {3.780608594021016*^9, 
   3.780608598250681*^9}, {3.780609148426017*^9, 3.780609151570249*^9}, {
   3.783924374180883*^9, 3.783924389179556*^9}, {3.78394370651175*^9, 
   3.783943724469323*^9}, 3.783996904669529*^9, {3.783996950045021*^9, 
   3.78399695219794*^9}, {3.783999542929183*^9, 3.783999552143003*^9}, {
   3.784001200998274*^9, 3.7840012064666433`*^9}, {3.784072300916572*^9, 
   3.784072308230904*^9}, 3.784074277000784*^9, 3.784082281236003*^9, {
   3.7841679705822487`*^9, 3.784167973064163*^9}, {3.7933971001984453`*^9, 
   3.7933971003875504`*^9}, {3.793397168270788*^9, 3.7933971815179567`*^9}, {
   3.793398297854368*^9, 3.793398298660182*^9}, {3.7992071251993227`*^9, 
   3.799207125205113*^9}},ExpressionUUID->"879ae065-c986-4ec2-8d74-\
efcd9a5730d9"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Single resistance", "Subsection",
 CellChangeTimes->{{3.780608535287355*^9, 
  3.780608537937509*^9}},ExpressionUUID->"3c9abcb4-ca5e-4cee-b4f8-\
346e57bde9d1"],

Cell[CellGroupData[{

Cell[TextData[{
 "Mean values & ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "ext"], TraditionalForm]],ExpressionUUID->
  "73b2fe02-3f23-45ed-b901-af2782a9b675"]
}], "Subsubsection",
 CellChangeTimes->{{3.765637718723462*^9, 
  3.7656377383885326`*^9}},ExpressionUUID->"73b1f900-74b8-45fc-8d68-\
13664dbe5c9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nS", "[", "t_", "]"}], ":=", 
    FractionBox["kS", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["kS", "n0"], "-", "1"}], ")"}], 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "\[Rho]S"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Mu]A", "-", "\[Mu]B"}], ")"}], " ", "t"}], 
        "]"}]}]}]]}], ";", 
   RowBox[{
    RowBox[{"Pext", "[", 
     RowBox[{"t_", ",", "T_", ",", "ki_", ",", "dib_", ",", "rib_"}], "]"}], ":=", 
    FractionBox[
     RowBox[{
      FractionBox["dib", "ki"], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"T", "-", "t"}], ")"}], "-", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"ki", "-", "1"}], ")"}], "rib"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "rib"}], 
             RowBox[{"(", 
              RowBox[{"T", "-", "t"}], ")"}]}], "]"}], "-", "1"}], ")"}]}]}], 
       ")"}]}], 
     RowBox[{
      RowBox[{
       FractionBox["dib", "ki"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"T", "-", "t"}], ")"}], "-", 
         RowBox[{
          FractionBox[
           RowBox[{"(", 
            RowBox[{"ki", "-", "1"}], ")"}], "rib"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "rib"}], 
              RowBox[{"(", 
               RowBox[{"T", "-", "t"}], ")"}]}], "]"}], "-", "1"}], ")"}]}]}],
         ")"}]}], "+", "1"}]]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"b", " ", "is", " ", "for", " ", "bar"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nAsol", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dS", "+", 
            RowBox[{"\[Rho]S", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{"nS", "[", "t", "]"}], "kS"]}], ")"}]}]}], ")"}], 
          "\[Mu]A", " ", 
          RowBox[{"nS", "[", "t", "]"}]}], "+", 
         RowBox[{"\[Rho]A", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]B"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{"n", "[", "t", "]"}], "kA"]}], ")"}], 
          RowBox[{"n", "[", "t", "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"n", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", "n", 
     ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", "nA", "}"}], "=", 
   RowBox[{"nAsol", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "All", ",", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nBsol", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dS", "+", 
            RowBox[{"\[Rho]S", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               FractionBox[
                RowBox[{"nS", "[", "t", "]"}], "kS"]}], ")"}]}]}], ")"}], 
          "\[Mu]B", " ", 
          RowBox[{"nS", "[", "t", "]"}]}], "+", 
         RowBox[{"\[Rho]B", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Mu]A"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            FractionBox[
             RowBox[{"n", "[", "t", "]"}], "kB"]}], ")"}], 
          RowBox[{"n", "[", "t", "]"}]}]}]}], ",", 
       RowBox[{
        RowBox[{"n", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", "n", 
     ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "tmax"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", "nB", "}"}], "=", 
   RowBox[{"nBsol", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "All", ",", "2"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.765637763026739*^9, 3.7656377634374857`*^9}, {
  3.7709118715611267`*^9, 3.7709118754684153`*^9}, {3.770912181215168*^9, 
  3.770912184133814*^9}, {3.770912487474399*^9, 3.770912488074915*^9}, {
  3.775312910608555*^9, 3.7753129749682302`*^9}, {3.7992071252093353`*^9, 
  3.799207125210651*^9}},ExpressionUUID->"2c11664e-7e16-429e-bba0-\
af0b32b7610a"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubsuperscriptBox["P", "R", "single"], 
  TraditionalForm]],ExpressionUUID->"aa070fd9-7d2c-4066-8a02-04d8703fee40"]], \
"Subsubsection",
 CellChangeTimes->{{3.765637507494335*^9, 3.7656375097419405`*^9}, {
  3.780608574210721*^9, 
  3.780608577456019*^9}},ExpressionUUID->"c76b7ea9-fe94-47ab-b3f5-\
f770419f7af3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WAB", "[", 
    RowBox[{"t_", ",", "\[Mu]i_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"dS", "+", 
      RowBox[{"\[Rho]S", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"nS", "[", "t", "]"}], "kS"]}], ")"}]}]}], ")"}], "\[Mu]i", 
    " ", 
    RowBox[{"nS", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhiA", "[", "T_", "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"WAB", "[", 
       RowBox[{"t", ",", "\[Mu]A"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Pext", "[", 
         RowBox[{"t", ",", "T", ",", "kA", ",", 
          RowBox[{"dA", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]B"}], ")"}]}], ",", 
          RowBox[{"\[Rho]A", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]B"}], ")"}]}]}], "]"}], "-", "1"}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PhiB", "[", "T_", "]"}], ":=", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"WAB", "[", 
       RowBox[{"t", ",", "\[Mu]B"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Pext", "[", 
         RowBox[{"t", ",", "T", ",", "kB", ",", 
          RowBox[{"dB", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]A"}], ")"}]}], ",", 
          RowBox[{"\[Rho]B", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]A"}], ")"}]}]}], "]"}], "-", "1"}], 
       ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PRSingle", "[", "T_", "]"}], ":=", 
   RowBox[{"1", "-", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"PhiA", "[", "T", "]"}], "+", 
      RowBox[{"PhiB", "[", "T", "]"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.763470267279829*^9, 3.7634703299659305`*^9}, {
   3.763470362311507*^9, 3.7634704844324107`*^9}, {3.763470808513151*^9, 
   3.7634708185663104`*^9}, {3.7634710534260044`*^9, 3.763471149766262*^9}, {
   3.7634715023862877`*^9, 3.7634715089059906`*^9}, {3.765423661508688*^9, 
   3.7654236618362083`*^9}, 3.765637747622471*^9, {3.7656377820106792`*^9, 
   3.765637819097666*^9}, {3.765637928388201*^9, 3.7656379389250755`*^9}, {
   3.775312910613069*^9, 3.7753129968004007`*^9}, {3.799207125214243*^9, 
   3.7992071252164793`*^9}},ExpressionUUID->"6a902040-80fc-48cb-b7c0-\
e3eb525443c3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Save data", "Subsubsection",
 CellChangeTimes->{{3.77495494476315*^9, 
  3.774954946243232*^9}},ExpressionUUID->"2bb195dd-253d-47a2-b682-\
764a1162f42b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "filename", " ", "=", " ", "\"\<non-int-log-param-7-kS-PRS-T=35\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"loopcount", "\[Equal]", "1"}], ",", " ", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Total number of iterations: \>\"", ",", "  ", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"maxp", "-", "minp"}], ")"}], "dp"], "+", "1"}]}], "]"}], 
      ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"DeleteFile", "[", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"filename", ",", "\"\<.txt\>\""}], "]"}], "]"}], ";"}], 
       "*)"}], 
      RowBox[{"file", "=", 
       RowBox[{"OpenAppend", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"filename", ",", "\"\<.txt\>\""}], "]"}], "]"}]}], ";"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Quiet", "[", 
  RowBox[{
   RowBox[{"dataTable", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"PRSingle", "[", "T", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "minT", ",", "maxT", ",", " ", "dT"}], "}"}]}], 
     "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{"WriteString", "[", 
     RowBox[{"file", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"ToString", "[", 
        RowBox[{
         RowBox[{"dataTable", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", " ", "InputForm"}], "]"}], 
       "]"}], ",", "\"\<\\t\>\""}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "dataTable", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"file", ",", "\"\<\\n\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{"loopcount", ",", "10"}], "]"}], "==", "0"}], ",", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<iteration: \>\"", ",", " ", "loopcount"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"loopcount", "+=", "1"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"loopcount", "==", 
    RowBox[{
     FractionBox[
      RowBox[{"(", 
       RowBox[{"maxp", "-", "minp"}], ")"}], "dp"], "+", "2"}]}], ",", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directory", "[", "]"}], ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"filename", ",", "\"\<-time\>\"", ",", "\"\<.txt\>\""}], 
          "]"}]}], "}"}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"T", ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", "minT", ",", "maxT", ",", " ", "dT"}], "}"}]}], 
       "]"}], ",", "\"\<Table\>\"", ",", 
      RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Directory", "[", "]"}], ",", 
         RowBox[{"StringJoin", "[", 
          RowBox[{
          "filename", ",", "\"\<-parameter\>\"", ",", "\"\<.txt\>\""}], 
          "]"}]}], "}"}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{"p", ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "minp", ",", "maxp", ",", " ", "dp"}], "}"}]}], 
       "]"}], ",", "\"\<Table\>\"", ",", 
      RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}], 
    ";", 
    RowBox[{"Close", "[", "file", "]"}], ";"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", " ", 
   RowBox[{
    RowBox[{"loopcount", " ", "<=", " ", 
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{"maxp", "-", "minp"}], ")"}], "dp"], "+", "1"}]}], ",", 
    RowBox[{"NotebookEvaluate", "@", 
     RowBox[{"EvaluationNotebook", "[", "]"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.79339907756586*^9, 3.793399079261347*^9}, 
   3.793399393238591*^9},
 CellLabel->"In[32]:=",ExpressionUUID->"47080c6d-f20b-434c-a6c5-fb36b16e51f4"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Total number of iterations: \"\>", "\[InvisibleSpace]", 
   "100.`"}],
  SequenceForm["Total number of iterations: ", 100.],
  Editable->False]], "Print",
 CellChangeTimes->{3.7933992051473293`*^9, 3.793399279822444*^9, 
  3.793399410538786*^9, 3.793399481973002*^9, 3.7933995967035017`*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"40325eb9-0224-479b-8260-adfdeaa76b8d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"iteration: \"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["iteration: ", 10],
  Editable->False]], "Print",
 CellChangeTimes->{3.793399599813882*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"f9f11d4a-9734-4ee3-abb4-9ed91d683900"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"iteration: \"\>", "\[InvisibleSpace]", "20"}],
  SequenceForm["iteration: ", 20],
  Editable->False]], "Print",
 CellChangeTimes->{3.793399603093525*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"8b2bf3fd-171a-44db-b45a-c93ccf1bc82b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"iteration: \"\>", "\[InvisibleSpace]", "30"}],
  SequenceForm["iteration: ", 30],
  Editable->False]], "Print",
 CellChangeTimes->{3.7933996075850687`*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"32a63181-4ed3-45c8-98f5-a46b8764cb9c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"iteration: \"\>", "\[InvisibleSpace]", "40"}],
  SequenceForm["iteration: ", 40],
  Editable->False]], "Print",
 CellChangeTimes->{3.79339961071303*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"b3cc7b8a-1df4-4e45-af3d-2601684f9281"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"iteration: \"\>", "\[InvisibleSpace]", "50"}],
  SequenceForm["iteration: ", 50],
  Editable->False]], "Print",
 CellChangeTimes->{3.79339961390701*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"37076626-7992-437a-a084-7fb8f12224bf"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"iteration: \"\>", "\[InvisibleSpace]", "60"}],
  SequenceForm["iteration: ", 60],
  Editable->False]], "Print",
 CellChangeTimes->{3.793399617262047*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"b4e8deba-30ae-4915-a832-2bc8785cde10"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"iteration: \"\>", "\[InvisibleSpace]", "70"}],
  SequenceForm["iteration: ", 70],
  Editable->False]], "Print",
 CellChangeTimes->{3.793399620554689*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"a9729ff2-1e37-4f78-8f57-15067148d20c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"iteration: \"\>", "\[InvisibleSpace]", "80"}],
  SequenceForm["iteration: ", 80],
  Editable->False]], "Print",
 CellChangeTimes->{3.793399624041099*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"b7f707ce-bb02-4735-8588-907891250a6f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"iteration: \"\>", "\[InvisibleSpace]", "90"}],
  SequenceForm["iteration: ", 90],
  Editable->False]], "Print",
 CellChangeTimes->{3.793399626862361*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"4359067e-a851-4c0a-a6f2-037f44ca72c8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"iteration: \"\>", "\[InvisibleSpace]", "100"}],
  SequenceForm["iteration: ", 100],
  Editable->False]], "Print",
 CellChangeTimes->{3.793399629591807*^9},
 CellLabel->
  "During evaluation of \
In[32]:=",ExpressionUUID->"096686ca-ba29-4eb0-a25e-6162bf5f5846"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Double resistance", "Subsection",
 CellChangeTimes->{{3.78060840916208*^9, 
  3.780608411384777*^9}},ExpressionUUID->"8f79d04a-4ed3-4fca-a800-\
fe25253dc51d"],

Cell[CellGroupData[{

Cell[TextData[{
 "Mean values & ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["P", "ext"], TraditionalForm]],ExpressionUUID->
  "6391e520-a94d-4471-b329-d7cfdd213c20"]
}], "Subsubsection",
 CellChangeTimes->{{3.765637718723462*^9, 
  3.7656377383885326`*^9}},ExpressionUUID->"b00337f4-3627-4ca6-8a9b-\
40b83627a2f8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"nS", "[", "t_", "]"}], ":=", 
      FractionBox["kS", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["kS", "n0"], "-", "1"}], ")"}], 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "\[Rho]S"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]A", "-", "\[Mu]B"}], ")"}], " ", "t"}], 
          "]"}]}]}]]}], ";", 
     RowBox[{
      RowBox[{"Pext", "[", 
       RowBox[{"t_", ",", "T_", ",", "ki_", ",", "dib_", ",", "rib_"}], "]"}],
       ":=", 
      FractionBox[
       RowBox[{
        FractionBox["dib", "ki"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"T", "-", "t"}], ")"}], "-", 
          RowBox[{
           FractionBox[
            RowBox[{"(", 
             RowBox[{"ki", "-", "1"}], ")"}], "rib"], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "rib"}], 
               RowBox[{"(", 
                RowBox[{"T", "-", "t"}], ")"}]}], "]"}], "-", "1"}], 
            ")"}]}]}], ")"}]}], 
       RowBox[{
        RowBox[{
         FractionBox["dib", "ki"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"T", "-", "t"}], ")"}], "-", 
           RowBox[{
            FractionBox[
             RowBox[{"(", 
              RowBox[{"ki", "-", "1"}], ")"}], "rib"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "rib"}], 
                RowBox[{"(", 
                 RowBox[{"T", "-", "t"}], ")"}]}], "]"}], "-", "1"}], 
             ")"}]}]}], ")"}]}], "+", "1"}]]}], ";"}], 
    RowBox[{"(*", 
     RowBox[{"b", " ", "is", " ", "for", " ", "bar"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"nAsol", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"dS", "+", 
              RowBox[{"\[Rho]S", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 FractionBox[
                  RowBox[{"nS", "[", "t", "]"}], "kS"]}], ")"}]}]}], ")"}], 
            "\[Mu]A", " ", 
            RowBox[{"nS", "[", "t", "]"}]}], "+", 
           RowBox[{"\[Rho]A", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Mu]B"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              FractionBox[
               RowBox[{"n", "[", "t", "]"}], "kA"]}], ")"}], 
            RowBox[{"n", "[", "t", "]"}]}]}]}], ",", 
         RowBox[{
          RowBox[{"n", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", "n", 
       ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tmax"}], "}"}]}], "]"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "nA", "}"}], "=", 
    RowBox[{"nAsol", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "All", ",", "2"}], "]"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"nBsol", "=", 
    RowBox[{"NDSolve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"n", "'"}], "[", "t", "]"}], "\[Equal]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dS", "+", 
             RowBox[{"\[Rho]S", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                FractionBox[
                 RowBox[{"nS", "[", "t", "]"}], "kS"]}], ")"}]}]}], ")"}], 
           "\[Mu]B", " ", 
           RowBox[{"nS", "[", "t", "]"}]}], "+", 
          RowBox[{"\[Rho]B", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Mu]A"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             FractionBox[
              RowBox[{"n", "[", "t", "]"}], "kB"]}], ")"}], 
           RowBox[{"n", "[", "t", "]"}]}]}]}], ",", 
        RowBox[{
         RowBox[{"n", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}], ",", "n", 
      ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "tmax"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "nB", "}"}], "=", 
    RowBox[{"nBsol", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "All", ",", "2"}], "]"}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.765637763026739*^9, 3.7656377634374857`*^9}, {
  3.7709118715611267`*^9, 3.7709118754684153`*^9}, {3.770912181215168*^9, 
  3.770912184133814*^9}, {3.770912487474399*^9, 3.770912488074915*^9}, {
  3.775312910608555*^9, 3.7753129749682302`*^9}, {3.7992071252220592`*^9, 
  3.79920712522304*^9}},ExpressionUUID->"87d60340-60ad-49c1-8331-\
7b865885b511"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Pext", "[", 
     RowBox[{"0", ",", "T", ",", "kD", ",", "dD", ",", "\[Rho]D"}], "]"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"T", ",", "0", ",", "10"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<t\>\"", ",", "\"\<n\>\""}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.765625598724476*^9, 3.7656256874943767`*^9}, {
   3.7656316691781683`*^9, 3.7656316692815633`*^9}, {3.765643701573969*^9, 
   3.765643701886777*^9}, {3.76567639328719*^9, 3.7656763980699368`*^9}, {
   3.7656765719388447`*^9, 3.765676594133629*^9}, {3.765676629794647*^9, 
   3.7656766524312563`*^9}, {3.7656769901357613`*^9, 
   3.7656769908257227`*^9}, {3.765677050853098*^9, 3.7656770539863977`*^9}, {
   3.765677118521731*^9, 3.765677130389662*^9}, {3.765678035370915*^9, 
   3.765678035614249*^9}, {3.765678262304325*^9, 3.765678345887557*^9}, {
   3.7656788008110857`*^9, 3.7656788756412992`*^9}, {3.765679000624077*^9, 
   3.765679000924827*^9}, {3.7656791045490017`*^9, 3.765679111640123*^9}, {
   3.7656792620331593`*^9, 3.765679280973222*^9}, {3.765679323242537*^9, 
   3.765679351319317*^9}, {3.765679487529684*^9, 3.765679492179645*^9}, {
   3.765680577629472*^9, 3.765680581864609*^9}, {3.765680670911664*^9, 
   3.765680671234995*^9}, {3.7656807635370398`*^9, 3.765680830389358*^9}, {
   3.7656820250137577`*^9, 3.765682041177784*^9}, {3.7656823318562202`*^9, 
   3.7656823463631277`*^9}, {3.765682493603653*^9, 3.765682515096517*^9}, {
   3.765682590559779*^9, 3.765682598634981*^9}, {3.76576099534538*^9, 
   3.7657610006694717`*^9}, {3.765761125502211*^9, 3.765761126137314*^9}, {
   3.765761233360979*^9, 3.765761233596231*^9}, {3.765761574884256*^9, 
   3.76576158900742*^9}, {3.765761977770547*^9, 3.765761979029508*^9}, {
   3.76578569143743*^9, 3.76578569160842*^9}, {3.7658826042451515`*^9, 
   3.7658826195672665`*^9}, {3.765882663740488*^9, 3.76588268367645*^9}, {
   3.7658827300889435`*^9, 3.7658827303227987`*^9}, {3.765886050582514*^9, 
   3.765886050961466*^9}, {3.7658934501111317`*^9, 3.765893457061974*^9}, {
   3.7658935628850613`*^9, 3.765893578974372*^9}, {3.766307655822106*^9, 
   3.766307673759898*^9}, {3.7663605800823727`*^9, 3.7663605803393373`*^9}, {
   3.766360839620227*^9, 3.7663608433339863`*^9}, {3.766361213134569*^9, 
   3.766361213353191*^9}, {3.76713404484984*^9, 3.767134052743834*^9}, {
   3.767221467777296*^9, 3.767221505051214*^9}, {3.767221535273717*^9, 
   3.767221536392653*^9}, {3.767225794618951*^9, 3.767225809731332*^9}, {
   3.767386901876669*^9, 3.7673869021800737`*^9}, {3.767694475371998*^9, 
   3.767694478760495*^9}, {3.767694523642655*^9, 3.767694545098425*^9}, {
   3.7676984195491*^9, 3.767698435882339*^9}, {3.767698502242231*^9, 
   3.76769850402433*^9}, {3.76769853899317*^9, 3.76769854055792*^9}, {
   3.767698656941104*^9, 3.7676986589055653`*^9}, {3.774267461279912*^9, 
   3.7742675177315826`*^9}, {3.774268287083928*^9, 3.7742682872508235`*^9}, {
   3.774268930091937*^9, 3.7742689311382875`*^9}, {3.7742760985952206`*^9, 
   3.774276101443453*^9}, {3.7746055317667513`*^9, 3.774605552746268*^9}, {
   3.774965444101664*^9, 3.7749654443711853`*^9}, {3.776908370901228*^9, 
   3.776908377935528*^9}, {3.77690861538592*^9, 3.776908654879833*^9}, {
   3.776908725266532*^9, 3.7769087287916193`*^9}, {3.776908995611539*^9, 
   3.77690900371332*^9}, {3.77690937761208*^9, 3.7769093779453*^9}, {
   3.776909879675824*^9, 3.776909880041409*^9}, {3.7770233997578163`*^9, 
   3.7770234054433126`*^9}, {3.777023451174693*^9, 3.777023451820242*^9}, {
   3.777035846369066*^9, 3.7770358809012623`*^9}, {3.7770359760845118`*^9, 
   3.77703597659447*^9}, {3.780525581183419*^9, 3.780525581387516*^9}, {
   3.78052584069681*^9, 3.7805258409414053`*^9}, {3.783944851025321*^9, 
   3.783944873510972*^9}, {3.783945042284848*^9, 3.783945047668532*^9}, {
   3.783945093526455*^9, 3.7839451561018963`*^9}, 
   3.7992071252274218`*^9},ExpressionUUID->"422d63d1-c09a-47d5-a234-\
73238845bdc1"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1: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
PQrAXbH07wb+IENz1k5awbj/B3AJ5Ic=
       "]]},
     Annotation[#, "Charting`Private`Tag$21025#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"t\"", TraditionalForm], 
    FormBox["\"n\"", TraditionalForm]},
  AxesOrigin->{Automatic, Automatic},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.7933992479297657`*^9, 3.7933993242770967`*^9, 
  3.793399450219314*^9, 3.79339952363918*^9, 3.793399639433505*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"2aa40008-d2d9-4786-9432-a8a053ea0177"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  SubsuperscriptBox["P", "R", "double"], 
  TraditionalForm]],ExpressionUUID->"a2f27ee0-c6bb-485e-b3a5-cb888c470d41"]], \
"Subsubsection",
 CellChangeTimes->{{3.765637507494335*^9, 3.7656375097419405`*^9}, {
  3.775319398309888*^9, 3.775319399404512*^9}, {3.7806084798183317`*^9, 
  3.780608502585227*^9}},ExpressionUUID->"11304d05-e133-47cc-84e9-\
a2fa2bda69e9"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"WD", "[", "t_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dA", " ", "+", " ", 
        RowBox[{"\[Rho]A", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"nA", "[", "t", "]"}], "kA"]}], ")"}]}]}], ")"}], 
      "\[Mu]B", " ", 
      RowBox[{"nA", "[", "t", "]"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dB", " ", "+", " ", 
        RowBox[{"\[Rho]B", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           FractionBox[
            RowBox[{"nB", "[", "t", "]"}], "kB"]}], ")"}]}]}], ")"}], 
      "\[Mu]A", " ", 
      RowBox[{"nB", "[", "t", "]"}]}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PhiD", "[", "T_", "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"WD", "[", "t", "]"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Pext", "[", 
          RowBox[{"t", ",", "T", ",", "kD", ",", "dD", ",", "\[Rho]D"}], 
          "]"}], "-", "1"}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "T"}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<GlobalAdaptive\>\"", ",", 
         RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0"}]}], "}"}]}], 
      ",", 
      RowBox[{"PrecisionGoal", "\[Rule]", "3"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PRDouble", "[", "T_", "]"}], ":=", 
    RowBox[{"1", "-", 
     RowBox[{"Exp", "[", 
      RowBox[{"PhiD", "[", "T", "]"}], "]"}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.7656379490060143`*^9, 3.7656379611205997`*^9}, {
  3.77531970188064*^9, 3.775319743193412*^9}, {3.780522909471652*^9, 
  3.780522909814599*^9}, {3.783945163520502*^9, 3.78394516499123*^9}, {
  3.7839970956515017`*^9, 3.783997095921115*^9}, {3.783997198535305*^9, 
  3.78399720052385*^9}, {3.783997274083622*^9, 3.7839972775625257`*^9}, {
  3.7992071252294083`*^9, 
  3.799207125230788*^9}},ExpressionUUID->"37236bfb-0911-41e5-be93-\
d73e2e36c237"]
}, Closed]],

Cell[CellGroupData[{

Cell["Save data", "Subsubsection",
 CellChangeTimes->{{3.77495494476315*^9, 
  3.774954946243232*^9}},ExpressionUUID->"cf020dbf-dcff-4ff9-b960-\
2df04c0cfb91"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "filename", " ", "=", " ", "\"\<non-int-log-param-7-kS-PRS-T=35\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"loopcount", "\[Equal]", "1"}], ",", " ", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Total number of iterations: \>\"", ",", "  ", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"maxp", "-", "minp"}], ")"}], "dp"], "+", "1"}]}], "]"}], 
      ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"DeleteFile", "[", 
         RowBox[{"StringJoin", "[", 
          RowBox[{"filename", ",", "\"\<.txt\>\""}], "]"}], "]"}], ";"}], 
       "*)"}], 
      RowBox[{"file", "=", 
       RowBox[{"OpenAppend", "[", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"filename", ",", "\"\<.txt\>\""}], "]"}], "]"}]}], ";"}]}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"dataTable", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"PRDouble", "[", "T", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", "minT", ",", "maxT", ",", " ", "dT"}], "}"}]}], 
       "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{"WriteString", "[", 
       RowBox[{"file", ",", 
        RowBox[{"StringJoin", "[", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"dataTable", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", " ", "InputForm"}], "]"}], 
         "]"}], ",", "\"\<\\t\>\""}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "dataTable", "]"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteString", "[", 
     RowBox[{"file", ",", "\"\<\\n\>\""}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"loopcount", ",", "10"}], "]"}], "==", "0"}], ",", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<iteration: \>\"", ",", " ", "loopcount"}], "]"}]}], "]"}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"loopcount", "+=", "1"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"loopcount", "==", 
      RowBox[{
       FractionBox[
        RowBox[{"(", 
         RowBox[{"maxp", "-", "minp"}], ")"}], "dp"], "+", "2"}]}], ",", 
     RowBox[{
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directory", "[", "]"}], ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{"filename", ",", "\"\<-time\>\"", ",", "\"\<.txt\>\""}], 
            "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"T", ",", 
          RowBox[{"{", 
           RowBox[{"T", ",", "minT", ",", "maxT", ",", " ", "dT"}], "}"}]}], 
         "]"}], ",", "\"\<Table\>\"", ",", 
        RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directory", "[", "]"}], ",", 
           RowBox[{"StringJoin", "[", 
            RowBox[{
            "filename", ",", "\"\<-parameter\>\"", ",", "\"\<.txt\>\""}], 
            "]"}]}], "}"}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"p", ",", 
          RowBox[{"{", 
           RowBox[{"p", ",", "minp", ",", "maxp", ",", " ", "dp"}], "}"}]}], 
         "]"}], ",", "\"\<Table\>\"", ",", 
        RowBox[{"\"\<FieldSeparators\>\"", "\[Rule]", "\"\< \>\""}]}], "]"}], 
      ";", 
      RowBox[{"Close", "[", "file", "]"}], ";"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", " ", 
     RowBox[{
      RowBox[{"loopcount", " ", "<=", " ", 
       RowBox[{
        FractionBox[
         RowBox[{"(", 
          RowBox[{"maxp", "-", "minp"}], ")"}], "dp"], "+", "1"}]}], ",", 
      RowBox[{"NotebookEvaluate", "@", 
       RowBox[{"EvaluationNotebook", "[", "]"}]}]}], "]"}], ";"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.782854273982423*^9, 3.782854286621915*^9}, {
   3.7828543426568336`*^9, 3.7828543574573183`*^9}, {3.782854415924898*^9, 
   3.782854417274076*^9}, {3.7828545361117268`*^9, 3.782854536390749*^9}, {
   3.782854657480781*^9, 3.782854677842123*^9}, {3.782855501816674*^9, 
   3.782855506731333*^9}, {3.7828560707905607`*^9, 3.782856133783558*^9}, 
   3.782856245259453*^9, {3.7828565207015944`*^9, 3.782856537076377*^9}, {
   3.782857098619582*^9, 3.7828570990555887`*^9}, {3.782857194642062*^9, 
   3.782857203386574*^9}, {3.782858298561133*^9, 3.782858300320779*^9}, 
   3.782859155846434*^9, {3.78285938777665*^9, 3.782859388447014*^9}, {
   3.782860181617668*^9, 3.782860188332708*^9}, {3.782860308164214*^9, 
   3.782860310192844*^9}, {3.7828610153353786`*^9, 3.782861035527055*^9}, {
   3.782861111401474*^9, 3.782861118313387*^9}, {3.7828611547886333`*^9, 
   3.782861220574897*^9}, 3.782861384517941*^9, {3.782862055052763*^9, 
   3.782862055153224*^9}, {3.782862282341007*^9, 3.782862293704775*^9}, 
   3.782862494221183*^9, 3.782877297289947*^9, 3.782877519346198*^9, {
   3.783077064925417*^9, 3.783077067074045*^9}, {3.783077296718169*^9, 
   3.783077299890749*^9}, {3.783570286537951*^9, 3.783570291656348*^9}, 
   3.783636625119585*^9, {3.783640900668268*^9, 3.7836409015937853`*^9}, {
   3.7836449267466297`*^9, 3.783644929608726*^9}, {3.783647257046253*^9, 
   3.783647259852255*^9}, {3.783924253042615*^9, 3.783924255936379*^9}, {
   3.783924288199787*^9, 3.783924292561895*^9}, {3.783944176837332*^9, 
   3.783944177499447*^9}, {3.7839969607834263`*^9, 3.783996962149797*^9}, 
   3.783997482178052*^9, {3.783999562243849*^9, 3.7839995629109383`*^9}, {
   3.784001227702486*^9, 3.784001228234714*^9}, 3.784002605361808*^9, {
   3.784072351666266*^9, 3.784072352272184*^9}, {3.784072759947404*^9, 
   3.78407276140808*^9}, {3.784082265722165*^9, 3.784082266408814*^9}, {
   3.784168016566072*^9, 3.78416801685203*^9}, 3.793397198433798*^9, {
   3.793397233499735*^9, 3.7933972354729652`*^9}, {3.793397940446913*^9, 
   3.793397963912168*^9}, {3.7933980059878893`*^9, 3.793398007088168*^9}, 
   3.793398343444766*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"23c94351-7e7c-4fd5-b75c-4b3f94aa8cd7"]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 655},
WindowMargins->{{163, Automatic}, {Automatic, 39}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->FrontEnd`FileName[{
   ParentDirectory[]}, "custom-stylesheet.nb", CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 616, 10, 69, "Section",ExpressionUUID->"fd1fea7a-d639-4048-bb8c-6dc468ec4f5d"],
Cell[1199, 34, 589, 9, 41, "Input",ExpressionUUID->"eb2c62ab-9bfd-4ed5-91fc-ec0003b94c68"],
Cell[1791, 45, 962, 22, 63, "Input",ExpressionUUID->"d6f25946-1477-4c1d-a92a-05b43dfff318"],
Cell[2756, 69, 1600, 31, 105, "Input",ExpressionUUID->"8d1b2e6a-2189-4251-93c7-e84b7e76a7bc"],
Cell[CellGroupData[{
Cell[4381, 104, 153, 3, 34, "Subsection",ExpressionUUID->"49094584-d4d6-4967-b208-7ac06f3597d7"],
Cell[4537, 109, 7150, 107, 105, "Input",ExpressionUUID->"403b47ee-0141-4f45-8e1d-89022d9e0ff6"],
Cell[CellGroupData[{
Cell[11712, 220, 167, 3, 33, "Subsubsection",ExpressionUUID->"86278049-6216-4081-87b2-53afb11d8d36"],
Cell[11882, 225, 4875, 97, 357, "Input",ExpressionUUID->"879ae065-c986-4ec2-8d74-efcd9a5730d9"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[16806, 328, 165, 3, 34, "Subsection",ExpressionUUID->"3c9abcb4-ca5e-4cee-b4f8-346e57bde9d1"],
Cell[CellGroupData[{
Cell[16996, 335, 315, 9, 33, "Subsubsection",ExpressionUUID->"73b1f900-74b8-45fc-8d68-13664dbe5c9f"],
Cell[17314, 346, 4687, 147, 333, "Input",ExpressionUUID->"2c11664e-7e16-429e-bba0-af0b32b7610a"]
}, Closed]],
Cell[CellGroupData[{
Cell[22038, 498, 353, 8, 36, "Subsubsection",ExpressionUUID->"c76b7ea9-fe94-47ab-b3f5-f770419f7af3"],
Cell[22394, 508, 2631, 75, 145, "Input",ExpressionUUID->"6a902040-80fc-48cb-b7c0-e3eb525443c3"]
}, Closed]],
Cell[CellGroupData[{
Cell[25062, 588, 159, 3, 33, "Subsubsection",ExpressionUUID->"2bb195dd-253d-47a2-b682-764a1162f42b"],
Cell[CellGroupData[{
Cell[25246, 595, 4407, 127, 480, "Input",ExpressionUUID->"47080c6d-f20b-434c-a6c5-fb36b16e51f4"],
Cell[CellGroupData[{
Cell[29678, 726, 445, 10, 24, "Print",ExpressionUUID->"40325eb9-0224-479b-8260-adfdeaa76b8d"],
Cell[30126, 738, 307, 8, 24, "Print",ExpressionUUID->"f9f11d4a-9734-4ee3-abb4-9ed91d683900"],
Cell[30436, 748, 307, 8, 24, "Print",ExpressionUUID->"8b2bf3fd-171a-44db-b45a-c93ccf1bc82b"],
Cell[30746, 758, 309, 8, 24, "Print",ExpressionUUID->"32a63181-4ed3-45c8-98f5-a46b8764cb9c"],
Cell[31058, 768, 306, 8, 24, "Print",ExpressionUUID->"b3cc7b8a-1df4-4e45-af3d-2601684f9281"],
Cell[31367, 778, 306, 8, 24, "Print",ExpressionUUID->"37076626-7992-437a-a084-7fb8f12224bf"],
Cell[31676, 788, 307, 8, 24, "Print",ExpressionUUID->"b4e8deba-30ae-4915-a832-2bc8785cde10"],
Cell[31986, 798, 307, 8, 24, "Print",ExpressionUUID->"a9729ff2-1e37-4f78-8f57-15067148d20c"],
Cell[32296, 808, 307, 8, 24, "Print",ExpressionUUID->"b7f707ce-bb02-4735-8588-907891250a6f"],
Cell[32606, 818, 307, 8, 24, "Print",ExpressionUUID->"4359067e-a851-4c0a-a6f2-037f44ca72c8"],
Cell[32916, 828, 309, 8, 24, "Print",ExpressionUUID->"096686ca-ba29-4eb0-a25e-6162bf5f5846"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33298, 844, 164, 3, 34, "Subsection",ExpressionUUID->"8f79d04a-4ed3-4fca-a800-fe25253dc51d"],
Cell[CellGroupData[{
Cell[33487, 851, 315, 9, 33, "Subsubsection",ExpressionUUID->"b00337f4-3627-4ca6-8a9b-40b83627a2f8"],
Cell[33805, 862, 4917, 147, 255, "Input",ExpressionUUID->"87d60340-60ad-49c1-8331-7b865885b511"],
Cell[CellGroupData[{
Cell[38747, 1013, 4105, 63, 41, "Input",ExpressionUUID->"422d63d1-c09a-47d5-a234-73238845bdc1"],
Cell[42855, 1078, 8115, 153, 249, "Output",ExpressionUUID->"2aa40008-d2d9-4786-9432-a8a053ea0177"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[51019, 1237, 401, 8, 34, "Subsubsection",ExpressionUUID->"11304d05-e133-47cc-84e9-a2fa2bda69e9"],
Cell[51423, 1247, 2132, 58, 110, "Input",ExpressionUUID->"37236bfb-0911-41e5-be93-d73e2e36c237"]
}, Closed]],
Cell[CellGroupData[{
Cell[53592, 1310, 159, 3, 33, "Subsubsection",ExpressionUUID->"cf020dbf-dcff-4ff9-b960-2df04c0cfb91"],
Cell[53754, 1315, 6645, 156, 439, "Input",ExpressionUUID->"23c94351-7e7c-4fd5-b75c-4b3f94aa8cd7"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

